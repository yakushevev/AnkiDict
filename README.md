# Генератор словарей Anki из CSV

Проект для генерации словарей в формате `.apkg` для Anki из двух CSV файлов с поддержкой TTS озвучки.

**GitHub**: https://github.com/yakushevev/AnkiDict

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

```bash
python main.py <csv1> <csv2> [опции]
```

### Параметры

- `csv1` - Путь к первому CSV файлу (слова и иероглифы)
- `csv2` - Путь ко второму CSV файлу (переводы)
- `-o, --output` - Имя выходного файла .apkg (по умолчанию: `chinese_dict.apkg`)
- `-d, --deck-name` - Название колоды Anki (по умолчанию: `Chinese Dictionary`)
- `--audio-dir` - Директория для кэширования аудио файлов (по умолчанию: `audio_cache`)

### Пример

```bash
python main.py words.csv translations.csv -o my_dict.apkg -d "Мой словарь"
```

## Формат CSV файлов

### Первый CSV файл (слова и иероглифы)

Формат строки:
```
первая_буква;произношение;иероглиф1;иероглиф2;...;иероглиф9;слова1;слова2;...;слова5
```

Пример:
```
s;shí;时;食;十;实;;;;;;十, 时间, 零食, 食物, 食堂, 时间;;;什么时候, 平时, 的时候, 有时候;
s;shì;是;室;市;视;试;世;柿;事;氏;卧室, 超市, 办公室, 电视, 室友, 西红柿, 考试, 试衣间, 城市, 会议室, 同事, 姓氏, 故事, 电视剧, 市中心, 我也是, 没事把;有事儿;是;可是, 当是;还是
```

### Второй CSV файл (переводы)

Формат строки:
```
слово;произношение;перевод
```

Перевод должен быть в формате: `тип1: значение1 | тип2: значение2`

Пример:
```
会;huì;глаг.: уметь, мочь | сущ.: собрание
```

## Формат карточек

### Лицевая сторона
- Крупно по центру: слово
- Снизу: произношение
- Автоматическая озвучка

### Оборотная сторона
1. **Перевод слова** - многоуровневый список по типам (глагол, наречие, прилагательное и т.д.)
2. **Разбор иероглифов** - для каждого иероглифа:
   - Слова через запятую с таким же иероглифом в составе
   - **Омофоны** - иероглифы с идентичным звучанием (произношением)

## Особенности

- Автоматическое удаление дубликатов слов
- Генерация озвучки через Google TTS (gTTS)
- Кэширование аудио файлов для ускорения повторной генерации
- Красивое HTML оформление карточек
- **Умная обработка омофонов** - автоматическое определение иероглифов с одинаковым произношением

## Обработка омофонов

Проект автоматически определяет и отображает омофоны (иероглифы с одинаковым произношением) для каждого иероглифа в слове:

1. **Из первого CSV файла**: Все иероглифы, указанные в одной строке, автоматически считаются омофонами друг друга, так как они имеют одинаковое произношение в этой строке.

   Например, в строке `s;shí;时;食;十;实` иероглифы 时, 食, 十, 实 являются омофонами (все произносятся как "shí").

2. **Из второго CSV файла**: Иероглифы с одинаковым произношением также связываются как омофоны.

3. **На карточке**: Для каждого иероглифа в слове отображается список всех омофонов (иероглифов с таким же звучанием), что помогает лучше запоминать и различать похожие по звучанию иероглифы.

Это особенно полезно при изучении китайского языка, где многие иероглифы имеют одинаковое произношение, но разное написание и значение.

## Структура проекта

```
ankiDict/
├── main.py              # Основной скрипт
├── csv_parser.py        # Парсер CSV файлов
├── anki_generator.py    # Генератор карточек Anki
├── tts_handler.py       # Обработчик TTS
├── requirements.txt     # Зависимости
└── README.md           # Документация
```

## Зависимости

- `genanki` - для генерации .apkg файлов
- `gtts` - для генерации озвучки
- `pydub` - для работы с аудио (опционально)

## Примечания

- Для работы TTS требуется подключение к интернету
- Аудио файлы кэшируются в директории `audio_cache` для ускорения повторной генерации
- Слова автоматически дедуплицируются при парсинге
